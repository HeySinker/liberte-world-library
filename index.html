<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ø±Ù‘</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='48' fill='%230a0e14' stroke='%2300ff00' stroke-width='2'/%3E%3Cpath d='M35 45 Q35 35 50 35 Q65 35 65 45' fill='none' stroke='%2300ff00' stroke-width='3' stroke-linecap='round'/%3E%3Ccircle cx='40' cy='45' r='3' fill='%2300ff00'/%3E%3Ccircle cx='60' cy='45' r='3' fill='%2300ff00'/%3E%3Cpath d='M30 60 L70 60' stroke='%2300ff00' stroke-width='2' stroke-linecap='round'/%3E%3Cpath d='M50 25 L50 15 M40 28 L35 20 M60 28 L65 20' stroke='%2300ff00' stroke-width='2' stroke-linecap='round'/%3E%3Cpath d='M25 70 Q50 80 75 70' fill='none' stroke='%2300ff00' stroke-width='2'/%3E%3C/svg%3E">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Courier New', 'Consolas', monospace; background: #0a0e14; min-height: 100vh; padding: 20px; direction: rtl; color: #00ff00; }
        .container { max-width: 1400px; margin: 0 auto; background: #1a1f2e; border-radius: 8px; padding: 40px; box-shadow: 0 0 40px rgba(0, 255, 0, 0.1); border: 1px solid #2a3f5f; }
        
        .header { text-align: center; margin-bottom: 50px; padding-bottom: 30px; border-bottom: 2px solid #00ff00; }
        .header h1 { font-size: 2.8em; color: #00ff00; margin-bottom: 10px; font-weight: 700; text-shadow: 0 0 10px rgba(0, 255, 0, 0.5); }
        .header p { color: #7f8c8d; font-size: 1.2em; }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØªØ¨ */
        .stats-container {
            margin-top: 15px;
            display: inline-block;
            padding: 5px 20px;
            background: rgba(0, 255, 0, 0.05);
            border: 1px solid #00ff00;
            border-radius: 20px;
            font-weight: bold;
            color: #00ff00;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
            box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.1);
        }

        .search-box { max-width: 600px; margin: 30px auto 0; position: relative; }
        .search-box input { width: 100%; padding: 15px 50px 15px 20px; border: 2px solid #2a3f5f; border-radius: 4px; font-size: 1em; background: #0d1117; color: #00ff00; font-family: 'Courier New', monospace; transition: all 0.3s; }
        .search-box input:focus { outline: none; border-color: #00ff00; box-shadow: 0 0 10px rgba(0, 255, 0, 0.3); }
        .search-icon { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: #7f8c8d; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª */
        .breadcrumb-container {
            margin: 20px 0 30px 0;
            padding: 15px;
            background: #0d1117;
            border: 1px solid #2a3f5f;
            border-radius: 4px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .breadcrumb {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            min-height: 45px;
        }

        .breadcrumb-item {
            background: #1a1f2e;
            color: #00ff00;
            padding: 8px 16px;
            border-radius: 4px;
            border: 1px solid #2a3f5f;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-weight: 600;
            font-size: 0.95em;
        }

        .breadcrumb-item:hover {
            background: #00ff00;
            color: #0a0e14;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
        }

        .breadcrumb-item.active {
            background: #00ff00;
            color: #0a0e14;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
        }

        .breadcrumb-separator {
            color: #7f8c8d;
            font-weight: bold;
        }

        /* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© */
        .category-title {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 255, 0, 0.05);
            border-left: 4px solid #00ff00;
            border-radius: 4px;
        }

        .category-title h2 {
            color: #00ff00;
            font-size: 1.5em;
            margin: 0;
        }

        .category-title p {
            color: #7f8c8d;
            margin: 5px 0 0 0;
            font-size: 0.95em;
        }
        
        .books-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        .book-card { background: #0d1117; border-radius: 4px; padding: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); transition: all 0.3s ease; border: 1px solid #2a3f5f; display: flex; flex-direction: column; align-items: center; text-align: center; position: relative; animation: fadeIn 0.4s ease; }
        .book-card:hover { transform: translateY(-8px); box-shadow: 0 0 20px rgba(0, 255, 0, 0.3); border-color: #00ff00; }
        
        .subfolder-badge { position: absolute; top: 10px; left: 10px; background: #0099ff; color: #0a0e14; padding: 4px 10px; border-radius: 3px; font-size: 0.75em; font-weight: 600; box-shadow: 0 0 10px rgba(0, 153, 255, 0.5); max-width: 85%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        .book-icon { width: 80px; height: 80px; background: #1a1f2e; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; color: #00ff00; border: 2px solid #2a3f5f; }
        .book-icon svg { width: 45px; height: 45px; }
        
        .book-title { font-size: 1.1em; color: #00ff00; margin-bottom: 10px; line-height: 1.4; font-weight: 600; min-height: 50px; display: flex; align-items: center; justify-content: center; word-break: break-word; }
        
        .book-meta { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; color: #7f8c8d; font-size: 0.9em; margin-bottom: 20px; }
        .book-size { background: #1a1f2e; padding: 4px 10px; border-radius: 3px; border: 1px solid #2a3f5f; }
        
        .download-btn { display: flex; align-items: center; justify-content: center; gap: 8px; background: #0d1117; color: #00ff00; padding: 12px 24px; border-radius: 4px; text-decoration: none; font-weight: 600; transition: all 0.3s; width: 100%; margin-top: auto; border: 2px solid #00ff00; cursor: pointer; }
        .download-btn:hover { background: #00ff00; color: #0a0e14; box-shadow: 0 0 20px rgba(0, 255, 0, 0.5); }
        
        .onion-link {
            margin-top: 15px;
            padding: 12px;
            background: #0d1117;
            border: 1px solid #2a3f5f;
            border-radius: 4px;
            font-size: 0.85em;
            text-align: center;
            word-wrap: break-word; 
            word-break: break-all;
            overflow-wrap: break-word;
        }

        .onion-link p {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        @media (min-width: 768px) {
            .onion-link p {
                flex-direction: row; 
                justify-content: center;
            }
        }

        .copy-link {
            cursor: pointer;
            color: #00ff00;
            background: rgba(0, 255, 0, 0.05);
            padding: 2px 6px;
            border-radius: 3px;
            border: 1px dashed #00ff00;
            display: inline-block;
            max-width: 100%;
        }

        .loading-text, .no-results { text-align: center; width: 100%; padding: 40px; color: #7f8c8d; font-size: 1.2em; grid-column: 1 / -1; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8em; }
            .container { padding: 20px 10px; }
            .books-grid { grid-template-columns: 1fr; }
            .breadcrumb-item { font-size: 0.85em; padding: 6px 12px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header class="header">
        <h1>ğŸ“š Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ø±Ù‘</h1>
        <p>Ø£Ø±Ø´ÙŠÙ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù†Ø§Ø¯Ø±Ø© Ùˆ Ø§Ù„Ù‚ÙŠÙ‘Ù…Ø©</p>
        
        <div class="stats-container" id="statsCounter">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª...</div>
        
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨ Ø£Ùˆ Ø§Ù„ØªØµÙ†ÙŠÙ..." autocomplete="off">
            <span class="search-icon">ğŸ”</span>
        </div>

        <div class="onion-link">
            <p>
                <span>ğŸ§… Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ:</span>
                <a href="http://7xk4m9p2qw8n5vt3bg6hj1rz0cd8efy4ua9slx2qi7nwmkopdvh3elad.onion/library" style="color: purble;">Onion Link</a>
            </p>
        </div>

        <div class="onion-link">
            <p>
                <span>Donate SOL:</span>
                <span class="copy-link" id="copySolBtn">SamJzu73QqdE2Htv7mmn9MUDALypWRoR2H51qon5R9F</span>
            </p>
        </div>

        <div class="onion-link">
            <p>
                <span>Donate BTC:</span>
                <span class="copy-link" id="copyBtcBtn">1SamUEdkg5qkNPojCuvepTUMjSvp4WiUN</span>
            </p>
        </div>
    </header>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª -->
    <div class="breadcrumb-container">
        <div class="breadcrumb" id="breadcrumb"></div>
    </div>

    <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
    <div class="category-title" id="categoryTitle" style="display: none;">
        <h2 id="categoryName"></h2>
        <p id="categoryCount"></p>
    </div>

    <main>
        <div id="booksGrid" class="books-grid">
            <div class="loading-text">Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ...</div>
        </div>
        <div id="loadMoreTrigger" style="height: 20px;"></div>
    </main>

    <footer style="text-align: center; margin-top: 50px; padding: 20px; border-top: 1px solid #2a3f5f; color: #4a5568;">
        <p>&copy; 2026 Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ø±Ù‘ - Ø§Ù„Ù…Ø¹Ø±ÙØ© Ù„Ù„Ø¬Ù…ÙŠØ¹</p>
    </footer>
</div>

<script>
    const R2_BASE_URL = "https://pub-50bb0a7170f24a0fb33dc91b892ffecc.r2.dev/";
    const JSON_URL = "https://lib.psychicalbeacon.com/books_db.json";
    
    let allBooks = [];       
    let displayedBooks = []; 
    let itemsToShow = 40;
    let currentCategory = null;
    let categories = {};
    
    const booksGrid = document.getElementById('booksGrid');
    const searchInput = document.getElementById('searchInput');
    const statsCounter = document.getElementById('statsCounter');
    const breadcrumb = document.getElementById('breadcrumb');
    const categoryTitle = document.getElementById('categoryTitle');

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠ (Ø¹Ø±Ø¨ÙŠ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)
    function sortByAlphabet(books) {
        return books.sort((a, b) => {
            const titleA = a.t || '';
            const titleB = b.t || '';
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… localeCompare Ù„Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­
            return titleA.localeCompare(titleB, ['ar', 'en'], { numeric: true });
        });
    }

    // 1. Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙ†Ø¸ÙŠÙ…Ù‡Ø§
    async function init() {
        try {
            const response = await fetch(JSON_URL);
            if (!response.ok) throw new Error('ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„');
            allBooks = await response.json();
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„ÙƒØªØ¨ Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            allBooks = sortByAlphabet(allBooks);
            
            // ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ÙƒØªØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø§Øª
            organizeBooks();
            
            // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            showAllCategories();
            
            updateCounter(allBooks.length);
            setupInfiniteScroll();
        } catch (error) {
            booksGrid.innerHTML = `<div class="no-results">âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø©: ${error.message}</div>`;
        }
    }

    // ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ÙƒØªØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø§Øª
    function organizeBooks() {
        categories = {};
        allBooks.forEach(book => {
            const category = book.f;
            if (!categories[category]) {
                categories[category] = [];
            }
            categories[category].push(book);
        });
        
        // ØªØ±ØªÙŠØ¨ Ø§Ù„ÙƒØªØ¨ Ø¯Ø§Ø®Ù„ ÙƒÙ„ ÙØ¦Ø© Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹
        Object.keys(categories).forEach(category => {
            categories[category] = sortByAlphabet([...categories[category]]);
        });
    }

    // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª
    function showAllCategories() {
        currentCategory = null;
        displayedBooks = [];
        
        // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù†Ø§Øª "ÙØ¦Ø©" Ù„Ø¹Ø±Ø¶Ù‡Ø§ ÙƒØ¨Ø·Ø§Ù‚Ø§Øª - Ù…Ø±ØªØ¨Ø© Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹
        const sortedCategoryNames = Object.keys(categories).sort((a, b) => 
            a.localeCompare(b, ['ar', 'en'], { numeric: true })
        );
        
        sortedCategoryNames.forEach(categoryName => {
            displayedBooks.push({
                t: categoryName,
                f: 'Ù…Ø¬Ù„Ø¯',
                s: `${categories[categoryName].length} ÙƒØªØ§Ø¨`,
                isCategory: true,
                categoryName: categoryName
            });
        });
        
        updateBreadcrumb();
        categoryTitle.style.display = 'none';
        updateCounter(displayedBooks.length);
        booksGrid.innerHTML = '';
        renderBooks();
    }

    // Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙŠØ§Øª ÙØ¦Ø© Ù…Ø¹ÙŠÙ†Ø©
    function showCategory(categoryName) {
        currentCategory = categoryName;
        displayedBooks = [...(categories[categoryName] || [])];
        
        updateBreadcrumb();
        
        // Ø¹Ø±Ø¶ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ¦Ø©
        categoryTitle.style.display = 'block';
        document.getElementById('categoryName').textContent = categoryName;
        document.getElementById('categoryCount').textContent = `${displayedBooks.length} ÙƒØªØ§Ø¨`;
        
        updateCounter(displayedBooks.length);
        booksGrid.innerHTML = '';
        renderBooks();
    }

    // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„
    function updateBreadcrumb() {
        breadcrumb.innerHTML = '';
        
        // Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        const homeBtn = document.createElement('span');
        homeBtn.className = 'breadcrumb-item' + (currentCategory === null ? ' active' : '');
        homeBtn.textContent = 'ğŸ“š Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
        homeBtn.style.cursor = 'pointer';
        
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… addEventListener Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† onclick
        homeBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            showAllCategories();
            return false;
        });
        
        breadcrumb.appendChild(homeBtn);
        
        if (currentCategory !== null) {
            const separator = document.createElement('span');
            separator.className = 'breadcrumb-separator';
            separator.textContent = ' / ';
            breadcrumb.appendChild(separator);
            
            const categoryBtn = document.createElement('span');
            categoryBtn.className = 'breadcrumb-item active';
            categoryBtn.textContent = currentCategory;
            breadcrumb.appendChild(categoryBtn);
        }
    }

    // 2. Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„ÙƒØªØ¨
    function renderBooks(append = false) {
        if (!append) booksGrid.innerHTML = '';
        
        const currentCount = append ? booksGrid.children.length : 0;
        const nextBatch = displayedBooks.slice(currentCount, currentCount + itemsToShow);

        if (nextBatch.length === 0 && !append) {
            booksGrid.innerHTML = '<div class="no-results">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ø¬Ù„Ø¯Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©.</div>';
            return;
        }

        const fragment = document.createDocumentFragment();
        nextBatch.forEach(book => {
            const card = document.createElement('div');
            card.className = 'book-card';
            
            if (book.isCategory) {
                // Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙØ¦Ø©
                const categoryName = book.categoryName;
                card.innerHTML = `
                    <div class="book-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10z"/></svg>
                    </div>
                    <h3 class="book-title">${book.t}</h3>
                    <div class="book-meta"><span class="book-size">${book.s}</span></div>
                `;
                
                const btn = document.createElement('button');
                btn.className = 'download-btn';
                btn.textContent = 'Ø¹Ø±Ø¶ Ø§Ù„ÙƒØªØ¨';
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… addEventListener Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† onclick
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    selectCategory(categoryName);
                    return false;
                });
                
                card.appendChild(btn);
            } else {
                // Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨
                let path = book.p;
                if (path && path.includes('file:///')) {
                    path = path.split('/').pop();
                }
                
                card.innerHTML = `
                    <div class="book-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 18H6a1 1 0 0 0 0 2h15v2H6a3 3 0 0 1-3-3V4a2 2 0 0 1 2-2h16v16zM5 16.05c.16-.03.33-.05.5-.05H19V4H5v12.05zM16 9H8V7h8v2zm0 4H8v-2h8v2z"/></svg>
                    </div>
                    <span class="subfolder-badge">${book.f}</span>
                    <h3 class="book-title">${book.t}</h3>
                    <div class="book-meta"><span class="book-size">${book.s}</span></div>
                    <a class="download-btn" href="${R2_BASE_URL + (path || '')}" download target="_blank">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ§Ø¨</a>
                `;
            }
            fragment.appendChild(card);
        });
        booksGrid.appendChild(fragment);
    }

    // Ø¯Ø§Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø©
    function selectCategory(categoryName) {
        showCategory(categoryName);
    }

    // 3. Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ÙÙˆØ±ÙŠ
    searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        
        if (query === "") {
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ©
            if (currentCategory === null) {
                showAllCategories();
            } else {
                showCategory(currentCategory);
            }
            return;
        }

        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙƒÙ„ Ø§Ù„ÙƒØªØ¨
        displayedBooks = allBooks.filter(b => 
            b.t.toLowerCase().includes(query) || b.f.toLowerCase().includes(query)
        );
        
        statsCounter.innerText = `ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰: ${displayedBooks.length} ÙƒØªØ§Ø¨`;
        categoryTitle.style.display = 'none';
        renderBooks(false);
    });

    // 4. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
    function updateCounter(count) {
        if (searchInput.value === "") {
            statsCounter.innerText = `Smart Book Counter: ${count.toLocaleString()}`;
        }
    }

    // 5. Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠ
    function setupInfiniteScroll() {
        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting && booksGrid.children.length < displayedBooks.length) {
                renderBooks(true);
            }
        }, { rootMargin: '200px' });
        observer.observe(document.getElementById('loadMoreTrigger'));
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø¨Ù†Ø¬Ø§Ø­!"));
    }

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', function() {
        const copySolBtn = document.getElementById('copySolBtn');
        const copyBtcBtn = document.getElementById('copyBtcBtn');
        
        if (copySolBtn) {
            copySolBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                copyToClipboard('SamJzu73QqdE2Htv7mmn9MUDALypWRoR2H51qon5R9F');
                return false;
            });
        }
        
        if (copyBtcBtn) {
            copyBtcBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                copyToClipboard('1SamUEdkg5qkNPojCuvepTUMjSvp4WiUN');
                return false;
            });
        }
    });

    init();
</script>

</body>
</html>
